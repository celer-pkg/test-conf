{
    "url": "https://gh-proxy.com/github.com/libffi/libffi/releases/download/v3.4.8/libffi-3.4.8.tar.gz",
    "ref": "v3.4.8",
    "build_configs": [
        {
            "pattern": "*linux*",
            "system_tools": [
                "autoconf",
                "libtoolize"
            ],
            "patches": [],
            "build_tool": "makefiles",
            "library_type": "shared",
            "options": [
                "--host=${HOST}",
                "--disable-docs",
                "--enable-portable-binary",
                "--disable-multi-os-directory"
            ]
        },
        {
            "pattern": "*windows*",
            "build_tool": "makefiles",
            "library_type": "shared",
            "patches": [
                "fix_configure.patch"
            ],
            "pre_install": {
                "scripts": [
                    "cmake -E rename ${BUILD_DIR}/.libs/libffi-8.lib ${BUILD_DIR}/.libs/libffi.lib"
                ]
            },
            "options": [
                "CC=\"${SOURCE_DIR}/msvcc.sh -m64\"",
                "CXX=\"${SOURCE_DIR}/msvcc.sh -m64\"",
                "LD=link",
                "CPP=\"cl -nologo -EP\"",
                "CXXCPP=\"cl -nologo -EP\"",
                "CPPFLAGS=\"-DFFI_BUILDING_DLL\"",
                "--host=${HOST}",
                "--disable-docs",
                "--enable-portable-binary",
                "--disable-multi-os-directory"
            ]
        }
    ]
}